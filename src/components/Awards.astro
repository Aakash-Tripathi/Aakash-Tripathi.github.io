---
import { awards, memberships, citations } from "../data/awards";
import { fetchCitationCount } from "../utils/googleScholar";

// Fetch citation count at build time
const fetchedCount = await fetchCitationCount();

// Use fetched count if available, otherwise fallback to hardcoded value
const citationData = {
  total: fetchedCount || citations.total,
  period: citations.period,
  lastUpdated: new Date().toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }),
  isFetched: fetchedCount !== null
};
---

<section class="awards">
  <h2>üèÜ Honors & Awards</h2>
  <div class="awards-list">
    {awards.map((award) => (
      <div class="award-item">
        <h3>{award.title}</h3>
        <p><strong>{award.organization}</strong> ({award.year})</p>
        <p>{award.description}</p>
        {award.prize && <p><em>Award: {award.prize}</em></p>}
        {award.date && <p><em>{award.date}</em></p>}
      </div>
    ))}
  </div>

  <h2>üéì Professional Memberships</h2>
  <div class="memberships-list">
    {memberships.map((membership) => (
      <div class="membership-item">
        <p><strong>{membership.organization}</strong></p>
        <p>{membership.role} ‚Ä¢ {membership.startDate} ‚Äì {membership.present ? 'Present' : membership.endDate}</p>
      </div>
    ))}
  </div>

  <h2>üìä Research Impact</h2>
  <div class="impact">
    <p><strong>Total Citations:</strong> {citationData.total} ({citationData.period})</p>
    {citationData.isFetched ? (
      <p class="last-updated">Last updated: {citationData.lastUpdated}</p>
    ) : (
      <p class="last-updated">From last manual update</p>
    )}
  </div>
</section>

<style>
  .awards-list, .memberships-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-top: 1rem;
  }

  .award-item, .membership-item {
    border-left: 3px solid var(--accent-color, #3b82f6);
    padding-left: 1rem;
  }

  .award-item h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
  }

  .award-item p, .membership-item p {
    margin: 0.25rem 0;
  }

  .impact {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--bg-secondary, #f3f4f6);
    border-radius: 8px;
  }

  .impact p {
    margin: 0;
    font-size: 1.1rem;
  }

  .last-updated {
    margin-top: 0.5rem !important;
    font-size: 0.9rem !important;
    color: var(--text-secondary, #6b7280);
    font-style: italic;
  }
</style>
